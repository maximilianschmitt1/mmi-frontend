<div class="habit-today-{{habit.today || 'pending'}}" ng-class="{ 'habit-list-item': true, toggled: toggled }">
  <header ng-click="toggle()" class="habit-overview">
    <level-indicator tooltips tooltip-title="Level" habit="habit"></level-indicator>
    <div>
      <div class="habit-name">
        <span
          tooltips
          tooltip-title="Tagesziel {{habit.today === 'success' ? 'erreicht' : habit.today === 'fail' ? 'nicht erreicht' : 'ausstehend'}}" 
          class="day-indicator"
          >
            Tag {{habit.daysSince}}
          </span>
        <h2>{{habit.name}}</h2>
      </div>
      <experience-bar
        tooltips
        tooltip-side="bottom"
        tooltip-title="{{habit.xp}} / {{habit.level.xpForNextLevel}} XP"
        habit="habit"></experience-bar>
    </div>
    <nav>
      <span class="activity-status" ng-if="habit.today">
        {{habit.today === 'success' ? 'Du hast das Tagesziel erreicht!' : 'Du hast das Tagesziel heute nicht erreicht. Morgen hast du wieder eine Chance!'}}
      </span>
      <button ng-if="!habit.today" ng-click="succeed(habit); $event.stopPropagation()" class="primary">Tagesziel erreicht</button>
      <button ng-if="!habit.today" ng-click="fail(habit); $event.stopPropagation()">verfehlt</button>
    </nav>
  </header>
  <section ng-if="toggled" class="habit-details">
    <div class="streak-box">
      <div
        tooltips
        tooltip-title="Tag {{day.day}} (Tagesziel {{day.type === 'success' ? 'erreicht' : day.type === 'fail' ? 'nicht erreicht' : 'ausstehend'}})"
        ng-repeat="day in habit.days track by $index"
        class="day {{day.type}} {{day.isToday ? 'today' : ''}}">
      </div>
    </div>
    <ul class="streak-stats">
      <li><span class="title">Aktuelle Erfolgsserie:</span> {{habit.currentStreak}} Tage</li>
      <li><span class="title">Längste andauerende Erfolgsserie:</span> {{habit.longestStreak}} Tage</li>
    </ul>
    <nav class="habit-options"><a class="danger" ng-click="delete(habit)">Habit löschen</a></nav>
  </section>
</div>